(let ((embedded-qt-lisp (find :eql *features*))) ; [EQL]
  (defun wait-for-streams (streams timeout)
    (loop
       (when (check-slime-interrupts) (return :interrupt))
       (let ((ready (remove-if-not #'stream-readable-p streams)))
         (when ready (return ready)))
       (when timeout (return nil))
       ;; [EQL]
       (if embedded-qt-lisp
	   (eql:qexec 100)
           (sleep 0.1)))))
